.model jjmod jj(Rtype=1, Vg=2.8mV, Cap=0.064pF, R0=100ohm, Rn=16ohm, Icrit=0.1mA)


*PYSQUID=========================================================================
.subckt psquid        3  5 
L1                 3         1   1.75pH fcheck
L2                 3         4   1.75pH fcheck
B1                 1         5  jjmod area=0.49
R1                 1         5   15.88ohm
B2                 2         5  jjmod area=0.49
R2                 2         5   15.88ohm
Q2                 4         2  jjmod area=20
R3                 4         2   0.2ohm
.ends

.subckt psquid2        3  5 
L1                 3         1   1.75pH fcheck
L2                 3         4   1.75pH fcheck
B1                 1         5  jjmod area=0.55
R1                 1         5   14.2ohm
B2                 2         5  jjmod area=0.55
R2                 2         5   14.2ohm
Q2                 4         2  jjmod area=20
R3                 4         2   0.2ohm
.ends

.subckt psquid3        3  5 
L1                 3         1   1.75pH fcheck
L2                 3         4   1.75pH fcheck
B1                 1         5  jjmod area=0.6
R1                 1         5   12.8ohm
B2                 2         5  jjmod area=0.6
R2                 2         5   12.8ohm
Q2                 4         2  jjmod area=20
R3                 4         2   0.2ohm
.ends

.subckt psquid4        3  5 
L1                 3         1   1.75pH fcheck
L2                 3         4   1.75pH fcheck
B1                 1         5  jjmod area=0.4
R1                 1         5   15.88ohm
B2                 2         5  jjmod area=0.4
R2                 2         5   15.88ohm
Q2                 4         2  jjmod area=20
R3                 4         2   0.2ohm
.ends
*================================================================================


.subckt HFQ_bias            1  3  4
L1               1        2   20pH fcheck
L2               2        3   20pH fcheck
R1               2        4   130ohm
.ends

.subckt HFQ_bias_non        1  3  
L1               1        2   20pH fcheck
L2               2        3   20pH fcheck
.ends


.subckt DCHFQ 1 10 100
Vin                     1        0    PWL(0ps 0mV 240ps 0mV 250ps 25mV 350ps 25mV 360ps 0mV 740ps 0mV 750ps 25mV 850ps 25mV 860ps 0mV 1240ps 0mV 1250ps 25mV 1350ps 25mV 1360ps 0mV)
Rin                     1        2    50ohm
L0                      2        3    2pH fcheck
L1                      3        0    4pH fcheck
X1       psquid         3        4
L3                      4        5    4.00pH fcheck
L4                      5        6    2.00pH fcheck
R1                      100      5    100ohm
X2       psquid         6        0
X3       DCHFQ_JTL      6        7     100
X4       DCHFQ_JTL      7        8     100
X5       DCHFQ_JTL      8        9     100
X6       DCHFQ_JTL      9        10    100
.ends


.subckt DCHFQ_JTL     1  5  100
L1               1  2   18pH fcheck
L2               2  3   18pH fcheck
L3               3  4   18pH fcheck
L4               4  5   18pH fcheck
X1    psquid     3  0
X2    psquid     5  0
R1               100  4   50ohm
.ends

.subckt JTL     1  5  200
L1               1  2   #(L)pH fcheck
L2               2  3   #(L)pH fcheck
L3               3  4   #(L)pH fcheck
L4               4  5   #(L)pH fcheck
X1    psquid     3  0
X2    psquid     5  0
R1               200  4   #(R)ohm
.ends

*v*R=(50;80;110;5)

*v*L=(18;3;20;3)


.subckt JTL4    1  5  200
X1       JTL            1  2  200
X2       JTL            2  3  200
X3       JTL            3  4  200
X4       JTL            4  5  200
.ends


.subckt DFF 1 7 12 100
L1                   1  2  10pH fcheck  
X1       psquid      2  3
L2                   3  7  18pH fcheck

L3                   4  5  18pH fcheck
L4                   5  6  18pH fcheck
X2       psquid      6  0
L5                   6  7  2pH  fcheck
R1                   100  7  100ohm
L6                   7  8  20pH fcheck
L7                   8  9  10pH fcheck
X2       psquid      9  0
.ends

*** top cell: 
X0       DCHFQ         1     2  100
X1       JTL4          2     3  200
X2       JTL4          3     4  200
X3       psquid        4     0
R1                     4     5  8.32ohm
L1                     5     0  2pH fcheck
Vb                     100   0  pwl(0ps 0mV 100ps 1.2mV)
Vb2                    200   0  pwl(0ps 0mV 100ps #(Vbias)mV)


*v*Vbias=(1.2;0.4;2.0;0.2)

**netlis file
.tran 1.0ps 6000ps 0ps 1ps


.print phase B1|X1|X3|X0
.print phase B2|X1|X3|X0

.print phase B1|X1|X5|X0
.print phase B2|X1|X5|X0

.print phase B1|X1|X1|X1
.print phase B2|X1|X1|X1

.print phase B1|X1|X1|X2
.print phase B2|X1|X1|X2

.end
