.model jjmod jj(Rtype=1, Vg=2.8mV, Cap=0.064pF, R0=100ohm, Rn=16ohm, Icrit=0.1mA)

.subckt psquid        3  5 
L1                 3         1   1.75pH fcheck
L2                 3         4   1.75pH fcheck
B1                 1         5  jjmod area=0.49
R1                 1         5   15.88ohm
B2                 2         5  jjmod area=0.49
R2                 2         5   15.88ohm
Q2                 4         2  jjmod area=20
R3                 4         2   0.2ohm
.ends

.subckt psquid2        3  5 
L1                 3         1   1.75pH fcheck
L2                 3         4   1.75pH fcheck
B1                 1         5  jjmod area=0.55
R1                 1         5   14.2ohm
B2                 2         5  jjmod area=0.55
R2                 2         5   14.2ohm
Q2                 4         2  jjmod area=20
R3                 4         2   0.2ohm
.ends

.subckt psquid3        3  5 
L1                 3         1   1.75pH fcheck
L2                 3         4   1.75pH fcheck
B1                 1         5  jjmod area=0.6
R1                 1         5   12.8ohm
B2                 2         5  jjmod area=0.6
R2                 2         5   12.8ohm
Q2                 4         2  jjmod area=20
R3                 4         2   0.2ohm
.ends

.subckt psquid4        3  5 
L1                 3         1   1.75pH fcheck
L2                 3         4   1.75pH fcheck
B1                 1         5  jjmod area=0.4
R1                 1         5   15.88ohm
B2                 2         5  jjmod area=0.4
R2                 2         5   15.88ohm
Q2                 4         2  jjmod area=20
R3                 4         2   0.2ohm
.ends

.subckt HFQ_bias         1  3  4
L1               1        2   20pH fcheck
L2               2        3   20pH fcheck
R1               2        4   130ohm
.ends

.subckt HFQ_bias1         1  3  
L1               1        2   20pH fcheck
L2               2        3   20pH fcheck
.ends

.subckt HFQ_bias2         1  3  4
L1               1        2   20pH fcheck
L2               2        3   20pH fcheck
R1               2        4   #(O)ohm
.ends

*v*O=(100;50;150;10)

.subckt DCHFQ 1 8 100
Vin               1        0   PWL(0ps 0mV 240ps 0mV 250ps 25mV 350ps 25mV 360ps 0mV 740ps 0mV 750ps 25mV 850ps 25mV 860ps 0mV 1240ps 0mV 1250ps 25mV 1350ps 25mV 1360ps 0mV)
Rin               1        20   1050ohm
L01                20        2   2pH fcheck
L0                2        0   42pH fcheck
L1                2        21   2pH fcheck
X1       psquid    21        22
L3             22        33   2.00pH fcheck
L4             33        3   2.00pH fcheck
X2       psquid2    3        0

X3       psquid         4  0
X4       psquid         5  0
X5       psquid         6  0
X6       psquid         7  0

X11      HFQ_bias1    3  4
X12      HFQ_bias    4  5  100
X13      HFQ_bias1    5  6
X14      HFQ_bias    6  7  100
X15      HFQ_bias1    7  8

R1               100      33  150ohm
.ends

.subckt DCHFQ2 1 8 100
Vin               1        0   PWL(0ps 0mV 490ps 0mV 500ps 25mV 600ps 25mV 610ps 0mV 1740ps 0mV 1750ps 25mV 1850ps 25mV 1860ps 0mV 2240ps 0mV 2250ps 25mV 2350ps 25mV 2360ps 0mV 2740ps 0mV 2750ps 25mV 2850ps 25mV 2860ps 0mV)
Rin               1        20   1050ohm
L01                20        2   2pH fcheck
L0                2        0   40pH fcheck
L1                2        21   2pH fcheck
X1       psquid    21        22
L3             22        33   2.00pH fcheck
L4             33        3   2.00pH fcheck
X2       psquid2    3        0

X3       psquid         4  0
X4       psquid         5  0
X5       psquid         6  0
X6       psquid         7  0

X11      HFQ_bias1    3  4
X12      HFQ_bias    4  5  100
X13      HFQ_bias1    5  6
X14      HFQ_bias    6  7  100
X15      HFQ_bias1    7  8

R1               100      33  150ohm
.ends

.subckt JTL4 1 5 100
X1       psquid         1  0
X12      HFQ_bias    1  2  100
X2       psquid         2  0
X23      HFQ_bias1    2  3
X3       psquid         3  0
X34      HFQ_bias    3  4  100
X4       psquid         4  0
X45      HFQ_bias1    4  5
.ends

.subckt DFF 5 1 9 100
X1       psquid      1 0
X2       psquid      2 0
X12      HFQ_bias2   1 2 100
L1       2 3  10pH fcheck
X3       psquid      4 3
L2       4 7  10pH fcheck
X4       psquid      5 0
L3       5 6 20pH fcheck
L4       6 7 10pH fcheck
L5       7 8 10pH fcheck
X5       psquid      8 0
X50      HFQ_bias1   8 9 100
R1       100 6 130ohm
.ends

.subckt DFF2 4 1 9 100
L1                   1   2 30pH fcheck
X1       psquid      2   0
L2                   2   3 48pH fcheck
R1                   100 3 40ohm
L3                   3   8 24pH fcheck

L4                   4   5 30pH fcheck
X2       psquid      5   0
R2                   100 5 40ohm
L5                   5   6 16pH fcheck
X3       psquid      6   7
L6                   7   8 16pH fcheck

L7                   8   9 24pH fcheck
X4       psquid      9   0
.ends

*** top cell: 
X0       DCHFQ         1  2 100
X1       JTL4          2  3 100

X2       DCHFQ2         4  5 100
X3       JTL4          5  6 100

X4       DFF            3  6  7 100

X5       JTL4          7  8 100
X6       psquid        8  0
R1       8 9 8.32ohm
L1       9 0 2pH fcheck

Vb                100         0 pwl(0ps 0mV 100ps #(Vbias)mV)
*v*Vbias=(2.8;2;4;0.1)

*** jsim input file ***
.tran 0.1ps 6000ps 0ps 1ps
*.file OUT

.print phase  B1|X2|X0
.print phase  B2|X2|X0

.print phase  B1|X1|X1
.print phase  B2|X1|X1

.print phase  B1|X4|X4
.print phase  B2|X4|X4
.end
